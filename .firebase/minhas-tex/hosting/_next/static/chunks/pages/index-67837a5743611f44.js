(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,l,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(8808)}])},8808:function(e,l,t){"use strict";t.r(l),t.d(l,{default:function(){return A}});var i=t(5893),s=t(2211),a=t(1211);function n(e){var l;let t=e.deleteIssue||e.selectIssue;return(0,i.jsx)("div",{className:"flex flex-wrap justify-center m-2 mb-4 p-1",children:null===(l=e.issues)||void 0===l?void 0:l.map((l,n)=>(0,i.jsxs)("div",{className:"flex flex-col flex-grow w-full shadow-2xl md:w-1/2 lg:w-1/3 xl:w-1/4 border border-gray-700 p-2 m-2 text-gray-700 dark:text-gray-300",children:[(0,i.jsxs)("div",{className:"flex flex-row justify-between mb-2",children:[(0,i.jsxs)("span",{children:["#",l.edition]}),(0,i.jsxs)("span",{children:[l.month," / ",l.year]})]}),(0,i.jsxs)("div",{className:"flex flex-row h-48",children:[(0,i.jsx)("div",{className:"w-1/3 mr-2 h-full shadow-xl",children:(0,i.jsx)("img",{src:l.coverURL,className:"h-full w-full object-contain"})}),(0,i.jsxs)("div",{className:"w-2/3 h-full flex flex-col",children:[(0,i.jsx)("div",{className:"text-xl font-bold flex justify-center mb-1 border-b border-gray-700",children:l.title}),(0,i.jsxs)("div",{className:"flex grow flex-col justify-center",children:[(0,i.jsxs)("span",{children:["Escrito por: ",l.writer?l.writer:"N\xe3o informado"," "]}),(0,i.jsxs)("span",{children:["Arte por: ",l.artist?l.artist:"N\xe3o informado"," "]}),(0,i.jsxs)("span",{children:["Pre\xe7o: ",(0,i.jsx)(s.Z,{value:l.price?l.price:"N\xe3o informado"})]}),(0,i.jsxs)("span",{children:["P\xe1ginas: ",l.pagesQty," "]}),(0,i.jsxs)("span",{children:["Cole\xe7\xe3o: ",l.collection?l.collection:"N\xe3o informado"," "]})]})]})]}),(0,i.jsx)("div",{className:"flex justify-center",children:!!t&&(0,i.jsxs)("td",{className:"mt-4",children:[!!e.selectIssue&&(0,i.jsx)("button",{className:"mr-2 rounded-full p-2 hover:bg-yellow-500 transition-all duration-300",onClick:()=>{var t;return null===(t=e.selectIssue)||void 0===t?void 0:t.call(e,l)},children:a.yl}),!!e.deleteIssue&&(0,i.jsx)("button",{className:"ml-2 rounded-full p-2 hover:bg-red-700 transition-all duration-300",onClick:()=>{var t;return null===(t=e.deleteIssue)||void 0===t?void 0:t.call(e,l)},children:a.Fz})]})})]},l.id))})}var o=t(996),r=t(7294),c=t(1792),u=t(3867),d=t(7121),h=t(2463),v=t(5321),m=new WeakMap,x=new WeakMap,p=new WeakMap,f=new WeakMap,b=new WeakMap,g=new WeakMap,w=new WeakMap,j=new WeakMap,y=new WeakMap,N=new WeakMap,_=new WeakMap;class k{static empty(){return new k("",0,0,"normal","","",0)}get id(){return(0,d._)(this,m)}get edition(){return(0,d._)(this,x)}get title(){return(0,d._)(this,p)}get pagesQty(){return(0,d._)(this,f)}get collection(){return(0,d._)(this,b)}get coverURL(){return(0,d._)(this,g)}get month(){return(0,d._)(this,w)}get year(){return(0,d._)(this,j)}get price(){return(0,d._)(this,y)}get writer(){return(0,d._)(this,N)}get artist(){return(0,d._)(this,_)}constructor(e,l,t,i,s,a,n,o=null,r=null,c=null,u=null){(0,h._)(this,m,{writable:!0,value:void 0}),(0,h._)(this,x,{writable:!0,value:void 0}),(0,h._)(this,p,{writable:!0,value:void 0}),(0,h._)(this,f,{writable:!0,value:void 0}),(0,h._)(this,b,{writable:!0,value:void 0}),(0,h._)(this,g,{writable:!0,value:void 0}),(0,h._)(this,w,{writable:!0,value:void 0}),(0,h._)(this,j,{writable:!0,value:void 0}),(0,h._)(this,y,{writable:!0,value:void 0}),(0,h._)(this,N,{writable:!0,value:void 0}),(0,h._)(this,_,{writable:!0,value:void 0}),(0,v._)(this,p,e),(0,v._)(this,x,l),(0,v._)(this,f,t),(0,v._)(this,b,i),(0,v._)(this,g,s),(0,v._)(this,w,a),(0,v._)(this,j,n),(0,v._)(this,y,o),(0,v._)(this,N,r),(0,v._)(this,_,c),(0,v._)(this,m,u)}}var C=t(1314),Z=t(3453),M=t(2357);function E(e){var l,t,s,a,n,o,d,h,v,m,x,p,f,b,g,w,j,y,N,_,E;let{user:S}=(0,M.Z)(),I=null!==(x=null===(l=e.issue)||void 0===l?void 0:l.id)&&void 0!==x?x:null,[P,W]=(0,r.useState)(null!==(p=null===(t=e.issue)||void 0===t?void 0:t.title)&&void 0!==p?p:""),[A,R]=(0,r.useState)(null!==(f=null===(s=e.issue)||void 0===s?void 0:s.edition)&&void 0!==f?f:0),[L,U]=(0,r.useState)(null!==(b=null===(a=e.issue)||void 0===a?void 0:a.pagesQty)&&void 0!==b?b:0),[F,Q]=(0,r.useState)(null!==(g=null===(n=e.issue)||void 0===n?void 0:n.collection)&&void 0!==g?g:""),[q,J]=(0,r.useState)(null),[O,T]=(0,r.useState)(null!==(w=e.issue.coverURL)&&void 0!==w?w:""),[D,z]=(0,r.useState)(null!==(j=null===(o=e.issue)||void 0===o?void 0:o.month)&&void 0!==j?j:""),[X,G]=(0,r.useState)(null!==(y=null===(d=e.issue)||void 0===d?void 0:d.year)&&void 0!==y?y:0),[B,H]=(0,r.useState)(null!==(N=null===(h=e.issue)||void 0===h?void 0:h.price)&&void 0!==N?N:0),[K,V]=(0,r.useState)(null!==(_=null===(v=e.issue)||void 0===v?void 0:v.writer)&&void 0!==_?_:""),[Y,$]=(0,r.useState)(null!==(E=null===(m=e.issue)||void 0===m?void 0:m.artist)&&void 0!==E?E:""),{collections:ee}=(0,C.Z)(),el=()=>{let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",l="",t=e.length;for(let i=0;i<10;i++)l+=e.charAt(Math.floor(Math.random()*t));return l},et=e=>{let l=el(),t=e.name.split(".").pop(),i="".concat(l,".").concat(t);return new File([e],i,{type:e.type})},ei=async()=>{var l,t;if(!O&&!q){alert("Por favor, selecione uma imagem para a capa.");return}if(!P||!A||0===A||!L||0===L||!F||!D||!X||0===X){console.log(P,A,L,F,D,X),alert("Preencha todos os dados obrigat\xf3rios");return}if(q){let e=et(q),l=Z.t.ref("".concat(S.uid,"/capas/").concat(e.name));await l.put(e),t=await l.getDownloadURL()}else t=O;let i=new k(P,+A,+L,F,t,D,X,B,K,Y,I);null===(l=e.issueChanged)||void 0===l||l.call(e,i)};return(0,i.jsxs)("div",{className:"flex flex-col md:mx-40 lg:mx-80 my-10",children:[!!I&&(0,i.jsx)(u.Z,{readOnly:!0,text:"Codigo",value:I,className:"mb-4"}),(0,i.jsx)(u.Z,{text:"Titulo *",placeholder:"Ex: Tex no velho oeste",value:P,onChange:W,className:"mb-4"}),(0,i.jsx)(u.Z,{text:"Edi\xe7\xe3o *",placeholder:"Ex: 153",type:"number",value:A,onChange:R,className:"mb-4"}),(0,i.jsx)(u.Z,{text:"P\xe1ginas *",placeholder:"Ex: 198",type:"number",value:L,onChange:U,className:"mb-4"}),(0,i.jsx)("label",{className:"mb-2",children:"Cole\xe7\xe3o *"}),(0,i.jsxs)("select",{className:"\n                    bg-gray-700 border-b border-yellow-500 rounded-lg\n                    focus: outline-none px-4 py-2 text-black\n                ",id:"collections",onChange:e=>{Q(e.target.value)},children:[(0,i.jsx)("option",{value:"",children:"Escolha uma cole\xe7\xe3o"}),ee.map(e=>(0,i.jsx)("option",{value:e.name,children:e.name},e.id))]}),!I&&(0,i.jsxs)("div",{className:"flex flex-col my-4",children:[(0,i.jsx)("label",{className:"mb-2",children:"Capa *"}),(0,i.jsx)("input",{type:"file",onChange:e=>{e.target.files&&e.target.files[0]&&J(e.target.files[0])},required:!0})]}),(0,i.jsx)("label",{className:"mb-2",children:"M\xeas de lan\xe7amento *"}),(0,i.jsxs)("select",{className:"\n                    bg-gray-700 border-b border-yellow-500 rounded-lg\n                    focus: outline-none px-4 py-2 text-black\n                ",id:"month",value:D,onChange:e=>{z(e.target.value)},children:[(0,i.jsx)("option",{value:"",children:"Escolha um m\xeas"}),(0,i.jsx)("option",{value:"Janeiro",children:"Janeiro"}),(0,i.jsx)("option",{value:"Fevereiro",children:"Fevereiro"}),(0,i.jsx)("option",{value:"Mar\xe7o",children:"Mar\xe7o"}),(0,i.jsx)("option",{value:"Abril",children:"Abril"}),(0,i.jsx)("option",{value:"Maio",children:"Maio"}),(0,i.jsx)("option",{value:"Junho",children:"Junho"}),(0,i.jsx)("option",{value:"Julho",children:"Julho"}),(0,i.jsx)("option",{value:"Agosto",children:"Agosto"}),(0,i.jsx)("option",{value:"Setembro",children:"Setembro"}),(0,i.jsx)("option",{value:"Outubro",children:"Outubro"}),(0,i.jsx)("option",{value:"Novembro",children:"Novembro"}),(0,i.jsx)("option",{value:"Dezembro",children:"Dezembro"})]}),(0,i.jsx)(u.Z,{text:"Ano de lan\xe7amento *",type:"number",value:X,onChange:G,className:"mb-4"}),(0,i.jsx)(u.Z,{text:"Pre\xe7o",type:"number",value:B,onChange:H,className:"mb-4"}),(0,i.jsx)(u.Z,{text:"Roteiro por:",value:K,onChange:V,className:"mb-4"}),(0,i.jsx)(u.Z,{text:"Desenhos por:",value:Y,onChange:$,className:"mb-4"}),(0,i.jsxs)("div",{className:"flex justify-end mt-7",children:[(0,i.jsx)(c.Z,{color:"yellow",className:"mr-2",onClick:ei,children:I?"Alterar":"Salvar"}),(0,i.jsx)(c.Z,{onClick:e.canceled,color:"gray",children:"Cancelar"})]})]})}var S=new WeakMap;class I{async save(e){if(null==e?void 0:e.id)return await this.collection().doc(e.id).set(e),e;{let l=await this.collection().add(e);return(await l.get()).data()}}async delete(e){return this.collection().doc(e.id).delete()}async getAll(){var e;return null!==(e=(await this.collection().get()).docs.map(e=>e.data()))&&void 0!==e?e:[]}collection(){return Z.Z.firestore().collection("users/".concat(this.userId,"/issues")).withConverter((0,d._)(this,S))}constructor(e){(0,h._)(this,S,{writable:!0,value:void 0}),(0,v._)(this,S,{toFirestore:e=>({title:e.title,edition:e.edition,pagesQty:e.pagesQty,collection:e.collection,coverURL:e.coverURL,month:e.month,year:e.year,price:e.price,writer:e.writer,artist:e.artist}),fromFirestore(e,l){let t=e.data(l);return new k(t.title,t.edition,t.pagesQty,t.collection,t.coverURL,t.month,t.year,t.price,t.writer,t.artist,null==e?void 0:e.id)}}),this.userId=e}}var P=t(7495),W=t(1367);function A(){let{tableVisible:e,showTable:l,issue:t,issues:s,newIssue:a,saveIssue:u,setIssues:d,deleteIssue:h,selectIssue:v}=function(){let{user:e}=(0,M.Z)(),{collections:l,saveCollection:t}=(0,C.Z)(),[i,s]=(0,r.useState)(k.empty()),[a,n]=(0,r.useState)([]),{formVisible:o,tableVisible:c,showForm:u,showTable:d}=(0,P.Z)(),h=new I(null==e?void 0:e.uid);function v(){console.log("Getting all"),h.getAll().then(e=>{n(e),d()})}async function m(e){let i=e.id;n(e=>{let l=e.findIndex(e=>e.id===i);if(-1!==l){let t=[...e];return t.splice(l,1),t}return e});let s=l.find(l=>l.name===e.collection);var a=s.qtyEditions-1,o=s.qtyPages-e.pagesQty,r=Number(s.totalPrice)-Number(e.price);t(new W.Z(s.id,s.name,s.cover,a,o,r)),await h.delete(e);try{let l=Z.t.refFromURL(e.coverURL);await l.delete()}catch(e){console.error("Erro ao deletar o arquivo:",e)}}async function x(e){let i=l.find(l=>l.name===e.collection);var s=i.qtyEditions+1,a=i.qtyPages+e.pagesQty,n=Number(i.totalPrice)+Number(e.price);t(new W.Z(i.id,i.name,i.cover,s,a,n)),await h.save(e),d()}return(0,r.useEffect)(()=>{v()},[e]),{tableVisible:c,showTable:d,issue:i,issues:a,setIssues:n,newIssue:function(){s(k.empty()),u()},saveIssue:x,deleteIssue:m,selectIssue:function(e){s(e),u()},getAll:v}}(),{collections:m}=(0,C.Z)(),[x,p]=(0,r.useState)([]);return(0,r.useEffect)(()=>{p(s)},[s]),(0,i.jsx)(o.Z,{title:"Tex",subtitle:"Em contru\xe7ao",children:e?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex justify-between w-full",children:[(0,i.jsx)("div",{className:"ml-4",children:(0,i.jsxs)("select",{id:"collections",onChange:e=>{let l=e.target.value;"all"==l?p(s):p(s.filter(e=>e.collection===l))},className:"text-black dark:text-white bg-gray-200 dark:bg-gray-800 border-none back px-2 py-1",children:[(0,i.jsx)("option",{value:"all",children:"Mostrar todas"}),m.map(e=>(0,i.jsx)("option",{value:e.name,children:e.name},e.id))]})}),(0,i.jsx)("div",{className:"flex justify-end mb-5 mr-4 ",children:(0,i.jsx)(c.Z,{color:"yellow",onClick:a,children:"Cadastrar nova edi\xe7\xe3o"})})]}),(0,i.jsx)(n,{issues:x,selectIssue:v,deleteIssue:h})]}):(0,i.jsx)(E,{issue:t,issueChanged:e=>{u(e),d([...s,e])},canceled:l})})}}},function(e){e.O(0,[247,25,888,774,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);